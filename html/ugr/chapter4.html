
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>

<!--
	Copyright (c) 2001-2006 by Digital Mars
	All Rights Reserved
	www.digitalmars.com
  -->

<head>
<META http-equiv="content-type" content="text/html; charset=utf-8" >
<title>Digital Mars - Generating an Application Framework
</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
<div id="heading">
<a href="http://www.digitalmars.com/"><IMG SRC="dmlogo.gif" BORDER=0 WIDTH=270 HEIGHT=53 ALT="www.digitalmars.com"></a>

<a href="http://www.digitalmars.com/" title="www.digitalmars.com">Home</a>
| <a href="../advancedsearch.html" title="Search Digital Mars web site">Search</a>
| <a href="../ctg/ctg.html" title="Compiler & Tools Guide">CTG</a>
| <a href="../rtl/rtl.html" title="Runtime Library Reference">RTL</a>
| <a href="../ugr/ugr.html" title="IDDE Reference">IDDE</a>
| <a href="../stl/index.html" title="Standard Template Library">STL</a>

	<div id="lastupdate">Last update Fri Apr 28 16:30:16 2006
</div>
</div>

<!-- Generated by Ddoc from chapter4.d -->




<table border=1 cellpadding=8 cellspacing=0 frame="void" summary="this table is for layout only">
<tr>
<td valign="top" class="toc">
<small>
<center>
<form method="get" action="http://www.google.com/search">
<input id="q" name="q" size="10" value="IDDE Search" onFocus='if(this.value == "IDDE Search"){this.value="";}'>
<input type="hidden" id="domains" name="domains" value="www.digitalmars.com">
<input type="hidden" id="sitesearch" name="sitesearch" value="www.digitalmars.com/ugr">
<input type="hidden" id="sourceid" name="sourceid" value="google-search">
<input type="submit" id="submit" name="submit" value="Go">
</form>

    <a href="ugr.html"><b>IDDE<br>Reference</b></a><br><br>
</center>

<b>Part 1: Welcome to Digital Mars C++</b><br>
    1. <a href="chapter1.html">Introducing Digital Mars C++</a></br>
    2. <a href="chapter2.html">Introducing the IDDE</a></br>
<hr>
<b>Part 2: Creating an Application with Digital Mars C++</b><br>
    3. <a href="chapter3.html">Starting a Project and Defining Workspaces</a></br>
    4. <a href="chapter4.html">Generating an Application Framework</a></br>
    5. <a href="chapter5.html">Defining Classes and Their Hierarchies</a></br>
    6. <a href="chapter6.html">Editing Program Code</a></br>
    7. <a href="chapter7.html">Adding Look and Feel with Resources</a></br>
    8. <a href="chapter8.html">Testing an Application</a></br>
<hr>
<b>Part 3: Learning Digital Mars C++ by Example</b><br>
    9. <a href="chapter9.html">Introduction to the Tutorial</a></br>
    10. <a href="chapter10.html">Lesson 1: Create the DOS Application</a></br>
    11. <a href="chapter11.html">Lesson 2: Generate an Application Framework</a></br>
    12. <a href="chapter12.html">Lesson 3: Customize the Interface</a></br>
    13. <a href="chapter13.html">Lesson 4: Add Messages with ClassExpress</a></br>
    14. <a href="chapter14.html">Lesson 5: Add a Dialog Box with ClassExpress</a></br>
<hr>
<b>Part 4: More about Creating Programs</b><br>
    15. <a href="chapter15.html">More about Projects and Workspaces</a></br>
    16. <a href="chapter16.html">More about Project Build Settings</a></br>
    17. <a href="chapter17.html">More about AppExpress</a></br>
    18. <a href="chapter18.html">More about ClassExpress</a></br>
    19. <a href="chapter19.html">Class Editor Reference</a></br>
    20. <a href="chapter20.html">Hierarchy Editor Reference</a></br>
    21. <a href="chapter21.html">Text Editor Reference</a></br>
    22. <a href="chapter22.html">Using Version Control</a></br>
<hr>
<b>Part 5: More about Testing Programs</b><br>
    23. <a href="chapter23.html">Controlling and Configuring the Debugger</a></br>
    24. <a href="chapter24.html">Commands Available in Debugging Mode</a></br>
<hr>
<b>Part 6: About Managing Resources</b><br>
    25. <a href="chapter25.html">ResourceStudio Resource Editor</a></br>
    26. <a href="chapter26.html">Dialog Editor</a></br>
    27. <a href="chapter27.html">Menu, Accelerator and String Table Editors</a></br>
    28. <a href="chapter28.html">Bitmap, Cursor, Icon, and Font Editors</a></br>
    29. <a href="chapter29.html">Version Information and Custom Resource Editors</a></br>
<hr>
<b>Part 7: Appendixes</b><br>
    A. <a href="appendixa.html">Expression Evaluation</a></br>
    B. <a href="appendixb.html">IDDE Settings and Command-Line Options</a></br>
    C. <a href="appendixc.html">Using NetBuild</a></br>

</small>

<hr>


</td>
<td valign="top">


<h1>4. Generating an Application Framework</h1>

This chapter introduces application frameworks and the steps 
necessary to generate and build on such a framework. This process 
uses two tools: AppExpress and ClassExpress. 
<p>

Before reading this chapter, take look at the material in 
<a href="chapter3.html">Starting a Project and Defining Workspaces</a>
in the IDDE. 
AppExpress creates both an application framework (according to 
specifications you provide) and the project in which that framework 
resides. 
<p>


<a href="chapter17.html">More about AppExpress</a>
and
<a href="chapter18.html">More about ClassExpress</a>
are the reference chapters for the AppExpress and 
ClassExpress tools.


<h2>What Is an Application Framework?</h2>

An application framework is a standardized skeleton architecture for 
an object-oriented application. The framework is composed of C++ 
classes derived from base classes in the Microsoft Foundation Class 
(MFC) library. 
<p>

Using a framework to build an application dramatically shortens its 
development time. All the files needed to create the application are 
included in the skeleton program. Standard user interface 
components such as windows, menus, and toolbars are already 
defined. Some of the necessary connections between the defined 
C++ classes are established automatically. 
<p>

With a framework as a starting point and using the MFC library, you 
can build many different types of applications by: 

<ul>
	<li> Adding or changing user interface components with 
	ResourceStudio (see
	Chapter 7, "Adding Look and Feel with Resources") 

	<li> Creating new C++ classes, class methods, and class 
	member variables with ClassExpress 

	<li> Writing code 
</ul>

As you build application frameworks with AppExpress and 
ClassExpress, you will become familiar with message maps. Message 
maps summarize, within a data structure or table, all of the links 
between Windows messages and the methods (also called functions) 
of a particular class that process those messages. Each entry in a 
message map is a pair, consisting of a message identifier and a 
method that responds to that message. The method is said to handle 
the message. Methods referenced in message maps are also called 
message handlers, or simply handlers. 
<p>


Because message maps are used by MFC to route Windows 
messages to the messages' handlers, they provide the essential 
translations needed to present the event-driven model of the 
Windows API in an object-oriented guise. By automating the creation 
and maintenance of message maps, AppExpress and ClassExpress 
relieve you of much error-prone drudgery, and allow you to spend 
more of your development time writing code that implements 
functionality. 
<p>


The following sample message map was automatically generated by 
AppExpress for an MDI-style application framework: 


<pre>
    BEGIN_MESSAGE_MAP( CMainView, CView)
	//{{ AFX_MSG_MAP( CMainView) 
	// NOTE -ClassExpress will add and
	// remove mapping macros here. 
	// DO NOT EDIT what you see in these
	// blocks of generated code ! 
	//}} AFX_MSG_MAP
	// Standard printing commands 
	ON_COMMAND( ID_FILE_PRINT, CView::OnFilePrint)
	ON_COMMAND( ID_FILE_PRINT_PREVIEW, 
		CView:: OnFilePrintPreview)
	END_MESSAGE_MAP() 
</pre>

<h2>Creating a Framework with AppExpress</h2>

This section describes how to launch AppExpress and use it to 
generate an application framework. 

<h3>Launching AppExpress</h3>

From the IDDE main window, choose <b>AppExpress</b> from the <b>Tools</b> 
menu. This opens the window shown in Figure 4-1. 

<p>
	<img align="middle" src="figure4_1.gif">
<p>
	[Figure 4-1 AppExpress window]
<p>

<h3>Looking at the AppExpress window</h3>

The AppExpress window contains:

<ul>
	<li> A listbox at the upper left displaying the steps required 
	to create an application framework. The current selection 
	from this list determines which page of options is shown 
	in the larger pane to the right. 

	<li> A pane on the right showing the options associated with 
	the currently selected step. 

	<li> Buttons below the panes that you can use to navigate 
	among the steps, preview your work, or generate a 
	framework. 
</ul>

To navigate through the six pages of options, click on the name of a 
step in the steps list, or click on the Next or Previous button. 
Alternatively, press Control-n, where n is a number between 1 and 6 
representing the selected step's position in the steps list. 


<h3>Specifying an application framework</h3>

AppExpress divides the process of building a framework into six 
steps: 

<ul>
	<li> Select an application type 
	<li> Select a directory for the project 
	<li> Provide copyright information and project options 
	<li> Specify class names 
	<li> Specify source file names 
	<li> Specify help file names 
</ul>


These steps, which are briefly outlined here, do not have to be 
completed in this order. However, you will find it convenient to 
complete the first step— specifying application type options— before 
proceeding to any other step. All later steps contain some options 
that depend upon your choices in this step. 


<h4>Selecting an application type</h4>

To select an application type: 

<ol>
	<li> Select Application Type from the steps list in the 
	AppExpress window. 

	<li> Select an application type by clicking on a radio button 
	in the Applications group. There are six categories of 
	applications, two of which— SDI and MDI— can be made 
	OLE clients and/or servers. 
</ol>


Check the Include Help box if you want AppExpress to generate 
files from which a Windows help file can be created. Check the 32-
Bit Project box if you are building a 32-bit application. See
Chapter 17, "More about AppExpress"
for the details of how the 32-Bit 
Project check box combines with the selected application type to 
determine what AppExpress generates. 
<p>

Selecting application type options sets default options for many of 
the other steps in AppExpress. For example, if you select Dialog 
Box, AppExpress automatically creates three C++ classes with default 
class names in your skeleton program. You can change these 
defaults; for example, you can modify the default class names by 
selecting Names from the steps list. 


<h4>Selecting a directory for the project</h4>

To select a directory for your source files and project file: 

<ol>
	<li> Select the Select Directory item from the steps list. 
	The Select Directory options page opens as shown in 
	Figure 4-2. 


	<li> Select the appropriate drive and directory. Or, click on 
	Create New Directory to create and name a new 
	directory. AppExpress suggests the project name as the 
	new directory name, but you may change that default. 

<p>
	<img align="middle" src="figure4_2.gif">
<p>
	[Figure 4-2 Select Directory options]
</ol>

<h4>Providing copyright information and project options</h4> 

You can supply copyright information for your source code, and set 
the project's name, stack size, and heap size as follows: 


<ol>
	<li> Select Miscellaneous from the steps list. The 
	Miscellaneous options page opens as shown in 
	Figure 4-3. 

	<p>
	<img align="middle" src="figure4_3.gif">
	<p>
	[Figure 4-3 Miscellaneous options]

	<li> Provide copyright information in the appropriate fields. 
	AppExpress uses this information to write a copyright 
	notice in the comment header of all of your application's 
	source files, and to construct the application's <b>About</b> 
	dialog box. 

	<li> Specify the project name in the appropriate field. Stack 
	and heap sizes can be changed later in the <b>Project 
	Settings</b> dialog box. 
</ol>

<h4>Specifying class names</h4>

To view and change the names of C++ classes or their associated 
source files: 

<ol>
	<li> Select Names from the steps list. The Names options 
	page opens as shown in Figure 4-4. 

	<li> In the options pane, select a class from the Name drop-down 
	list automatically created by AppExpress. The class 
	names included in this list depend on the application 
	type you have selected. 

	<li> If you like, you can edit the selected class name. Note, 
	however, that C++ class names follow a standardized 
	naming convention. Using the default names allows your 
	program's structure to be easily understood by others. 

	<li> In the appropriate field, type the names of the header 
	and source files in which AppExpress should place the 
	class source code. 
</ol>


<b>Note:</b> 
The CAboutDlg class, which represents your 
application's About Box class, is always created in 
the same header and implementation files as the 
CWinApp-derived class (for example, CSDIAPP). 
<p>


To discard any changes you have made on this page, click on the Set 
Default Names button. 

<p>
	<img align="middle" src="figure4_4.gif">
<p>
	[Figure 4-4 Names options]
<p>

<h4>Naming source files</h4>

To edit filenames automatically generated by AppExpress: 

<ol>
	<li> Select File Names from the steps list. The File Names 
	options page opens as shown in Figure 4-5. 

	<li> In the options pane, click on the filename you want to 
	change. The files listed depend on the application type 
	you have selected. Their names correspond to their 
	functionality within the application. 

	<li> Edit the filename, but remember that these changes 
	could make it harder for someone else to identify the 
	purpose of the file. 

	<p>
	<img align="middle" src="figure4_5.gif">
	<p>
	[Figure 4-5 File Names options]
</ol>

<h4>Specifying help file names</h4> 

To view or change the names of the files that the help compiler uses 
to generate online help files for your application: 

<ol>
	<li> Select Help Options from the steps list. The Help 
	Options options page opens as shown in Figure 4-6. 

<p>
	<img align="middle" src="figure4_6.gif">
<p>
	[Figure 4-6 Help Options options]
<p>

	Note 
	If you selected Quick Console or Dialog Box as the 
	application type, or if Include Help is not selected 
	in the Application Type options page, then you 
	have no help options. 


	<li> Edit the filenames if you want. Note, however, that any 
	changes could make it harder for someone else to 
	identify the purpose of the file. 
</ol>

<h4>Generating an application framework</h4>

At this point, you have selected an application type and the directory 
in which the application project files will reside, and you may have 
customized various class names or filenames. AppExpress can now 
generate your application framework in the form of a skeleton 
program. 
<p>


Click on the Finish button in the AppExpress window. AppExpress 
generates the project and its source files, as you specified, hands it 
off to the project system, and closes. 
<p>


Note 
If you checked the Include Help box among the 
Application Type options, then you will need to 
build the help file for your application. You do this 
by running the makehelp. bat file that 
AppExpress creates in your project directory. 
<p>


Your skeleton program is ready. You can now build the program 
from within the IDDE, or you can add to your program by using 
other Digital Mars C++ tools. The next section shows how to enhance 
your application's C++ classes by using ClassExpress. 


<h2>Building on a Framework with ClassExpress</h2>

AppExpress cuts the work involved at the beginning of the 
application-building process. ClassExpress, on the other hand, 
enhances productivity throughout the rest of the process. You use 
this tool to flesh out the skeleton application produced by 
AppExpress. 
<p>


Specifically, you can use ClassExpress to: 

<ul>
	<li> Write message maps 

	<li> Create new classes derived from existing classes 

	<li> Create new class methods mapped to specific messages 

	<li> Create new class member variables (that is, data variables 
	that are members of a class) mapped to specific user-interface 
	objects 

	<li> Create new classes that can be OLE2 automation servers 
	or clients 

	<li> Create new classes that act as interfaces to Visual Basic 
	Custom Controls (also known as VBXs) 
</ul>


This chapter describes the first two of these options: writing message 
maps and creating new classes derived from existing classes. 
<p>

Message maps, defined in "What Is an Application Framework?" in 
this chapter, are discussed in greater detail in
Chapter 17, "More about AppExpress." 
<p>


You can use ClassExpress immediately after creating an application 
framework as well as at later points in development. For example, 
you probably want to wait until you have created some dialog boxes 
with ResourceStudio (see
Chapter 7, "Adding Look and Feel with Resources"
) before mapping class member variables to user interface 
objects. 


<h3>Launching ClassExpress</h3>

From the IDDE main menu, launch ClassExpress by choosing 
<b>ClassExpress</b> from the IDDE's <b>Tools</b> menu. 
<p>

Launching ClassExpress opens the window shown in Figure 4-7. 

<p>
	<img align="middle" src="figure4_7.gif">
<p>
	[Figure 4-7 ClassExpress window]

<h3>Looking at the ClassExpress window</h3>

The ClassExpress window contains: 

<ul>
	<li> A listbox at the upper left presenting the different kinds 
	of code that ClassExpress can generate 

	<li> A pane on the right showing the page of options 
	associated with each selection from the list at the upper 
	left 
</ul>


To navigate through the selections, click on the name of a selection 
in the list. Alternatively, use the key combination Control-n, where n 
is a number between 1 and 6 representing the position in the 
selections list of the selection to which you want to move. 


<h3>Writing a message map with ClassExpress</h3>

Message maps are tied to particular C++ classes. In ClassExpress, you 
can add to an existing message map by adding new linkages 
between messages and class methods. Or you can add a new 
message map for an entirely new class. 
<p>


ClassExpress runs from within the IDDE or as a stand-alone 
application. If run from within the IDDE, 
ClassExpress will be loaded with the IDDE's open project if there is 
one; otherwise, it prompts to open an existing project (which 
also opens the project in the IDDE's project system). 
<p>


As an example, the following steps demonstrate how to add a 
message handler to the CAboutDlg class of an SDI application 
generated by AppExpress: 


<ol>
	<li> Select Message Maps from the listbox. (If you just started 
	ClassExpress, this should already be selected.) The 
	ClassExpress window is displayed as shown in Figure 
	4-7. 

	<li> Select the class CAboutDlg from the Class drop-down list. 
	The contents of the three other lists in the options pane 
	are updated to reflect the following selection: 

	<ul>
		<li> Control IDs in Class: This list contains all of the menu 
		links and control IDs for which this class can add 
		handlers. For example, IDOK is a universally defined 
		constant for an OK button. Because the CAboutDlg class 
		includes an OK button by default, the IDOK constant is 
		always predefined for this class. 
		<p>

		Because this class represents a dialog box— which itself 
		can respond to many Windows messages— the first item 
		in the Control IDs in Class list is the name of the class 
		itself (CAboutDlg). 


		<li> Windows Messages: This list contains all of the Windows 
		messages that apply to the selected item in the Control 
		IDs in Class list. For example, if you highlight IDOK in 
		that list, two applicable messages (button notifications, in 
		this case) are displayed in the Windows Messages list: 
		BN_CLICKED and BN_DOUBLECLICKED. If a handler is 
		defined for a message, a red box appears before the 
		message name in this list. 


		<li> Function Name: This list contains all of the handlers that 
		exist within the selected class. These are the methods 
		that are linked to Windows messages. 
	</ul>


	<li> Select CAboutDlg from the Control IDs in Class list. The 
	list of Windows messages changes, revealing a long list 
	of messages to which your dialog box could respond. 


	<li> Double-click on WM_ACTIVATE. Notice that the method 
	OnActivate (in its fully prototyped form) is added to the 
	Function Name list. 
</ol>


Now, whenever your About dialog is activated, the OnActivate 
method is called in response to the dialog window receiving the 
message WM_ACTIVATE. With the four above steps, you have 
created an association between the message WM_ACTIVATE and the 
method OnActivate, and added it to the message map for the 
CAboutDlg class. 

<h3>Adding a new class to your application</h3>

Adding new classes to your application is as easy as creating a 
message map. To add a class: 

<ol>
	<li> Select Message Maps from the listbox. (If you just loaded 
	ClassExpress, then this should already be selected.) 

	<li> Click on the Add Class button. The Add Class dialog box 
	shown in Figure 4-8 opens. 

	<p>
	<img align="middle" src="figure4_8.gif">
	<p>
	[Figure 4-8 Add Class dialog box]

	<li> Select a class type from the Class Type drop-down list. 
	This type specifies the base class from which your new 
	class will be derived. The list displays names of MFC 
	classes without the initial letter 'C', thereby allowing you 
	to navigate rapidly within the list by typing the first letter 
	of a class type. For example, typing 'V' selects the View 
	class type. 

	<li> The New Class Name field becomes active, displaying a 
	suggested name for the new class. Edit this name as 
	appropriate. 

	<li> If you selected CDialog or CFormView, then the field 
	Dialog ID is displayed. Move to this field and choose the 
	resource ID of the dialog that you want to associate with 
	the new class's window. 

	<li> Check the OLE Automation box if you want your new 
	class to be a programmable OLE object. If you choose 
	this option, any other Windows application that is an 
	automation client can use the OLE interface you define 
	for this object. 

	<li> If you check the OLE Automation box and you are 
	deriving a new class from the CCmdTarget or CWnd 
	class, the Creatable check box is displayed. Check this 
	box if you want other applications to be able to create 
	the OLE automation object that you are defining. 

	<li> If you check the OLE Automation check box and you are 
	deriving a new class from the CCmdTarget or CWnd 
	class, you must also type a name in the External Name 
	field. This is the name that is exposed to other 
	applications that may want to use your OLE automation 
	object. 

	<li> Decide whether to edit the implementation filename of 
	your new class (shown in the last field in the Add Class 
	dialog box). By default, the base part of the filename is 
	the name of your new class without the initial letter 'C', 
	and truncated if necessary. 

	<li> Click OK to add the new C++ class to your application. If 
	you want, you can create message mappings for your 
	new class by using the steps outlined in the previous 
	section. 
</ol>

This section on ClassExpress showed how easy it is to write a 
message map and to create a new class. By just clicking on a check 
box, you can also add OLE automation support to your application. 
<p>


In addition, ClassExpress can bind your classes to your dialog boxes 
and generate C++ wrapper classes for Visual Basic custom controls 
(VBXs). It also provides extensive support for building OLE servers 
and containers. For more information on these features, refer to 
Chapter 18, "More about ClassExpress." 


<br><br><br><br>

</td></table>






<div id="copyright">
Copyright &copy; 1999-2006 by Digital Mars, All Rights Reserved |
Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>.
</div>

</body>
</html>

