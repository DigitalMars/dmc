
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>

<!--
	Copyright (c) 2001-2006 by Digital Mars
	All Rights Reserved
	www.digitalmars.com
  -->

<head>
<META http-equiv="content-type" content="text/html; charset=utf-8" >
<title>Digital Mars - Lesson 3: Customize the Interface
</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
<div id="heading">
<a href="http://www.digitalmars.com/"><IMG SRC="dmlogo.gif" BORDER=0 WIDTH=270 HEIGHT=53 ALT="www.digitalmars.com"></a>

<a href="http://www.digitalmars.com/" title="www.digitalmars.com">Home</a>
| <a href="../advancedsearch.html" title="Search Digital Mars web site">Search</a>
| <a href="../ctg/ctg.html" title="Compiler & Tools Guide">CTG</a>
| <a href="../rtl/rtl.html" title="Runtime Library Reference">RTL</a>
| <a href="../ugr/ugr.html" title="IDDE Reference">IDDE</a>
| <a href="../stl/index.html" title="Standard Template Library">STL</a>

	<div id="lastupdate">Last update Fri Apr 28 16:30:17 2006
</div>
</div>

<!-- Generated by Ddoc from chapter12.d -->





<table border=1 cellpadding=8 cellspacing=0 frame="void" summary="this table is for layout only">
<tr>
<td valign="top" class="toc">
<small>
<center>
<form method="get" action="http://www.google.com/search">
<input id="q" name="q" size="10" value="IDDE Search" onFocus='if(this.value == "IDDE Search"){this.value="";}'>
<input type="hidden" id="domains" name="domains" value="www.digitalmars.com">
<input type="hidden" id="sitesearch" name="sitesearch" value="www.digitalmars.com/ugr">
<input type="hidden" id="sourceid" name="sourceid" value="google-search">
<input type="submit" id="submit" name="submit" value="Go">
</form>

    <a href="ugr.html"><b>IDDE<br>Reference</b></a><br><br>
</center>

<b>Part 1: Welcome to Digital Mars C++</b><br>
    1. <a href="chapter1.html">Introducing Digital Mars C++</a></br>
    2. <a href="chapter2.html">Introducing the IDDE</a></br>
<hr>
<b>Part 2: Creating an Application with Digital Mars C++</b><br>
    3. <a href="chapter3.html">Starting a Project and Defining Workspaces</a></br>
    4. <a href="chapter4.html">Generating an Application Framework</a></br>
    5. <a href="chapter5.html">Defining Classes and Their Hierarchies</a></br>
    6. <a href="chapter6.html">Editing Program Code</a></br>
    7. <a href="chapter7.html">Adding Look and Feel with Resources</a></br>
    8. <a href="chapter8.html">Testing an Application</a></br>
<hr>
<b>Part 3: Learning Digital Mars C++ by Example</b><br>
    9. <a href="chapter9.html">Introduction to the Tutorial</a></br>
    10. <a href="chapter10.html">Lesson 1: Create the DOS Application</a></br>
    11. <a href="chapter11.html">Lesson 2: Generate an Application Framework</a></br>
    12. <a href="chapter12.html">Lesson 3: Customize the Interface</a></br>
    13. <a href="chapter13.html">Lesson 4: Add Messages with ClassExpress</a></br>
    14. <a href="chapter14.html">Lesson 5: Add a Dialog Box with ClassExpress</a></br>
<hr>
<b>Part 4: More about Creating Programs</b><br>
    15. <a href="chapter15.html">More about Projects and Workspaces</a></br>
    16. <a href="chapter16.html">More about Project Build Settings</a></br>
    17. <a href="chapter17.html">More about AppExpress</a></br>
    18. <a href="chapter18.html">More about ClassExpress</a></br>
    19. <a href="chapter19.html">Class Editor Reference</a></br>
    20. <a href="chapter20.html">Hierarchy Editor Reference</a></br>
    21. <a href="chapter21.html">Text Editor Reference</a></br>
    22. <a href="chapter22.html">Using Version Control</a></br>
<hr>
<b>Part 5: More about Testing Programs</b><br>
    23. <a href="chapter23.html">Controlling and Configuring the Debugger</a></br>
    24. <a href="chapter24.html">Commands Available in Debugging Mode</a></br>
<hr>
<b>Part 6: About Managing Resources</b><br>
    25. <a href="chapter25.html">ResourceStudio Resource Editor</a></br>
    26. <a href="chapter26.html">Dialog Editor</a></br>
    27. <a href="chapter27.html">Menu, Accelerator and String Table Editors</a></br>
    28. <a href="chapter28.html">Bitmap, Cursor, Icon, and Font Editors</a></br>
    29. <a href="chapter29.html">Version Information and Custom Resource Editors</a></br>
<hr>
<b>Part 7: Appendixes</b><br>
    A. <a href="appendixa.html">Expression Evaluation</a></br>
    B. <a href="appendixb.html">IDDE Settings and Command-Line Options</a></br>
    C. <a href="appendixc.html">Using NetBuild</a></br>

</small>

<hr>


</td>
<td valign="top">


<h1>12. Lesson 3: Customize the Interface</h1>


After an application framework has been generated with AppExpress, 
it is usually necessary to customize the user interface. This typically 
is an ongoing process; as your application evolves, you can add and 
remove interface elements. In this lesson you perform the initial 
stage of customization. You will: 

<ul>
	<li> Use ResourceStudio to customize TMLRead's menu and 
	toolbar 

	<li> Edit the code that sets up the toolbar 
</ul>

AppExpress generates an SDI application framework with a full set 
of resources. TMLRead needs only a subset of the standard user 
interface, so most of the work in this lesson involves trimming down 
the interface. At the end of the lesson you will have a modified 
version of TMLRead, supporting only the commands that are needed. 
<p>

Before starting this lesson, start the IDDE and open the project 
<tt>tmlread.prj</tt> found in directory 
<tt>samples\tutorial\lesson3\start</tt>. 


<h2>Launching ResourceStudio</h2>

An application's resources are contained in a resource script file, 
which includes descriptions of menus, dialog boxes, and other user 
interface elements. The resource script file is edited with 
ResourceStudio. To launch ResourceStudio: 

<ol>
	<li> Open the Project window by pressing Ctrl+Shift+P. 

	<li> In the Project window, double-click on <tt>tmlread.rc</tt>. 

	<li> When asked if you want to use ResourceStudio to edit 
	this file, click Yes. ResourceStudio starts, with its Shell 
	window minimized. (The Shell window is a control 
	center from which you can create and open resource 
	files. You will use it later in this lesson.) 
</ol>

The Browser window of ResourceStudio opens (Figure 12-1). 
The window controls editing of the resources within an individual 
resource file. On startup, its upper-left pane contains a list of 
resource types found in <tt>tmlread.rc</tt>. 

	<p>
	<img align="middle" src="figure12_1.gif">
	<p>
	[Figure 12-1 The Browser window of ResourceStudio]
	<p>

The TML Reader is only able to read and display TML files; it cannot 
edit or write them. Thus, you can remove menu items related to 
editing and saving. 


<h2>Customizing the Menu</h2>

In this section you customize TMLRead's menu. 
<p>

Within ResourceStudio are several individual editors, each capable of 
editing a single type of resource. For example, the Dialog editor is 
used to edit dialog box resources, and the Menu editor to edit menu 
resources. By default, the editors use the right pane of the Browser 
window. 
<p>


To start the Menu editor: 


<ol>
	<li> Click on Menu in the Browser window's upper-left pane. 
	<li> Double-click on IDR_MAINFRAME in the lower-left pane. 
</ol>


The Menu editor opens in the Browser window (Figure 12-2). Its 
menu replaces the Browser window's menu, and its toolbar appears 
at the top of the right pane. 

	<p>
	<img align="middle" src="figure12_2.gif">
	<p>
	[Figure 12-2 The Menu editor in the Browser window]
	<p>

As the Menu editor opens, the Property Sheet also opens (Figure 
12-2). This window is used to edit resource and resource element 
properties and options. 

	<p>
	<img align="middle" src="figure12_3.gif">
	<p>
	[Figure 12-3 The Property Sheet]
	<p>

The Test Menu pop-up window also opens simultaneously with the 
Menu editor (Figure 12-2). It is a top-level window whose menu is 
identical to the one you are editing. This window does nothing 
when you choose menu items that are not top-level menu items or 
submenus. 
<p>

Because changes you make to the menu in the Browser window are 
immediately reflected in the menu of the Test Menu window, you 
can verify your changes as you make them. 

	<p>
	<img align="middle" src="figure12_4.gif">
	<p>
	[Figure 12-4 The Test Menu window]
	<p>

Now you can remove unnecessary menus and menu items. 

<ol>
	<li> Click on "MENUITEM New" to select this menu item. 

	<li> Press Delete. 

	<li> Repeat the above steps to delete: 

	<ul>
		<li> "MENUITEM Save" 
		<li> "MENUITEM Save As" 
		<li> "POPUP Edit" 
		<li> "MENUITEM Index" 
		<li> "MENUITEM Using Help" and the following "SEPARATOR" 
	</ul>
</ol>


If you make a mistake, you can correct it by choosing <b>Undo</b> from 
the <b>Edit</b> menu. 
<p>

To close the Menu editor, choose <b>Close Editing</b> from the <b>File</b> menu, 
or press Escape. The Browser window menu and toolbar return. The 
right pane shows a preview of the menu. 
<p>

Although we have removed menu items for commands that will not 
be supported, at present it would still be possible to access some of 
those commands through their accelerators. In the next section we 
remove those commands from the accelerator table. 


<h2>Customizing the Accelerator Table</h2>

To start the Accelerator Table editor: 

<ol>
	<li> Click on Accelerator in the Browser window's upper-left 
	pane. 

	<li> Double-click on IDR_MAINFRAME in the lower-left pane. 
</ol>


The Accelerator Table editor opens in the Browser window (shown 
in Figure 12-5). As with the Menu editor, the Accelerator Table 
editor's menu replaces the Browser window's menu, and its toolbar 
appears at the top of the right pane. 

	<p>
	<img align="middle" src="figure12_5.gif">
	<p>
	[Figure 12-5 The Accelerator Table editor in the Browser window]
	<p>

Removing accelerators is quite similar to removing menu items. To 
remove the unnecessary accelerators: 


<ol>
	<li> Click on ID_FILE_NEW. 
	<li> Press Delete. 
	<li> Repeat the above steps for all the accelerators, leaving 
	only ID_FILE_OPEN and ID_FILE_PRINT. 
</ol>


As in the Menu editor and elsewhere in ResourceStudio, if you make 
a mistake, you can correct it by choosing <b>Undo</b> from the <b>Edit</b> menu. 
<p>

To close the Accelerator Table editor, press Escape. 
<p>

Commands may be sent to TMLRead in one other way: by clicking 
on buttons in the toolbar. In the next section we replace the toolbar 
bitmap with one containing only commands that are supported by 
TMLRead. 


<h2>Importing a New Toolbar Bitmap</h2>

Before importing a new toolbar bitmap, delete the current toolbar 
bitmap: 

<ol>
	<li> Click on Bitmap in the Browser window's upper-left 
	pane. 

	<li> Click on IDR_MAINFRAME in the lower left-pane. 

	<li> Press Shift+ Delete. 
</ol>

You must now copy a bitmap from another resource script file. To 
do this, you open a second Browser window to view the contents of 
a resource script file containing the new toolbar bitmap. Then you 
copy the bitmap to the clipboard and paste it into <tt>tmlread.rc</tt>. 


<ol>
	<li> Double-click the ResourceStudio icon to restore the Shell 
	window. 

	<li> In the Shell window, choose <b>Open</b> from the <b>File</b> menu. 

	<li> Select the file <tt>newbar.rc</tt> and click OK. 

	<li> In the upper-left pane of the new Browser window, click 
	on Bitmap. 

	<li> In the lower-left pane, click on IDB_NEWBAR. A 
	preview of the bitmap appears in the right pane 
	(Figure 12-6). 

	<p>
	<img align="middle" src="figure12_6.gif">
	<p>
	[Figure 12-6 New toolbar bitmap]
	<p>

	<li> Choose <b>Copy</b> from the <b>Edit</b> menu. The bitmap is copied 
	to the clipboard. 

	<li> Choose <b>Close</b> from the <b>File</b> menu. The second Browser 
	window closes. Activate the Browser window containing 
	<tt>tmlread.rc</tt> by clicking on it. 

	<li> Choose <b>Paste</b> from the <b>Edit</b> menu. The bitmap is added 
	to your application's resources. 
</ol>

The new toolbar does not presently have the correct resource ID. 
For the application framework to use it correctly, this toolbar's 
resource ID must be identical to that of the application's menu and 
accelerator table resources. To set the new bitmap's resource ID: 


<ol>
	<li> Click on the Property Sheet to bring it to the front. The 
	Property Sheet shows the resource ID and memory 
	options for the bitmap resource. 

	<li> From the ID drop-down list, select IDR_MAINFRAME. 
</ol>


The initial resource customization is now complete. Next you exit 
ResourceStudio and make a minor adjustment to update the source 
code that loads the toolbar. 


<h2>Exiting ResourceStudio</h2>

To save your work and exit Resource Studio: 

<ol>
	<li> Choose <b>Save</b> from the Browser window's <b>File</b> menu. 

	<li> Choose <b>Close</b> from the <b>File</b> menu. The Browser window 
	closes, but the Shell window and Property Sheet remain 
	open. 

	<li> Choose <b>Exit</b> from the Shell window's <b>File</b> menu. 
</ol>


<h2>Setting Up the New Toolbar</h2>

The MFC framework uses a single bitmap to represent a set of 
toolbar buttons. The correspondence between the button images in 
the bitmap and the commands they represent is established in an 
array in the source code. Because you have replaced the original 
toolbar bitmap, you also must update this array. 


<ol>
	<li> In the Project window, double-click on <tt>mainfrm.cpp</tt>. 
	A Source window opens, displaying the frame window 
	class's source code. 

	<li> Scroll downward a few lines until you find the following 
	code: 

	<pre>
	// toolbar buttons -IDs are command buttons
	static UINT BASED_CODE buttons[] = { 
		// same order as in the bitmap 'toolbar. bmp'
		ID_FILE_NEW, 
		ID_FILE_OPEN,
		ID_FILE_SAVE, 
		ID_SEPARATOR,
		ID_EDIT_CUT, 
		ID_EDIT_COPY,
		ID_EDIT_PASTE, 
		ID_SEPARATOR,
		ID_FILE_PRINT, 
		ID_APP_ABOUT,
		ID_CONTEXT_HELP, 
	}; 
	</pre>


	<li> Remove and rearrange lines until the array looks like 
	this: 


	<pre>
	// toolbar buttons -IDs are command buttons
	static UINT BASED_CODE buttons[] = { 
		// same order as in the new toolbar bitmap
		ID_FILE_OPEN, 
		ID_SEPARATOR,
		ID_FILE_PRINT, 
		ID_SEPARATOR,
		ID_APP_ABOUT, 
	};
	</pre>


	<li> Save the code by choosing <b>Save</b> from the Source 
	window's <b>File</b> menu. 
</ol>


The <tt>buttons[]</tt> array now contains the command IDs of the three 
toolbar buttons. The ID_SEPARATOR entries indicate where spaces 
should be placed between the button images when drawing the 
toolbar. 
<p>


In the last section you build the application and view the results of 
your labor. 


<h2>Building and Running the Application</h2>

To build and run the application, choose <b>Execute Program</b> from 
the IDDE <b>Project</b> menu. Because no executable has yet been built, 
the IDDE automatically builds TMLRead and then runs it. (When you 
try to run an existing executable that needs to be rebuilt, the IDDE 
asks if you want to rebuild the program before running it.) 
<p>


The source files are recompiled, the resource script is compiled by 
the resource compiler, and all the object files and resources are 
linked together to create the final application. Then the IDDE 
minimizes itself and executes the application (Figure 12-7). 
<p>

You can verify that the changes you made to the menu and toolbar 
are correct. To close the application, choose <b>Exit</b> from the <b>File</b> 
menu. 

	<p>
	<img align="middle" src="figure12_7.gif">
	<p>
	[Figure 12-7 TMLRead with customized menu and toolbar]
	<p>

You now have completed initial customization of TMLRead's 
resources. You deleted excess menu items and accelerators and 
installed a new toolbar bitmap. More changes to the application's 
resources can be made as the need arises; in Lesson 5, for example, 
you will return to ResourceStudio to add support for a Preferences 
dialog box. In the next lesson, though, you will use ClassExpress to 
install functions to handle Windows messages, such as those 
generated by key presses and button clicks. 


<br><br><br><br>

</td></table>







<div id="copyright">
Copyright &copy; 1999-2006 by Digital Mars, All Rights Reserved |
Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>.
</div>

</body>
</html>

