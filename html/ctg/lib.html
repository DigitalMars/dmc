
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>

<!--
	Copyright (c) 2001-2006 by Digital Mars
	All Rights Reserved
	www.digitalmars.com
  -->

<head>
<META http-equiv="content-type" content="text/html; charset=utf-8" >
<title>Digital Mars - LIB: Object File Librarian
</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
<div id="heading">
<a href="http://www.digitalmars.com/"><IMG SRC="dmlogo.gif" BORDER=0 WIDTH=270 HEIGHT=53 ALT="www.digitalmars.com"></a>

<a href="http://www.digitalmars.com/" title="www.digitalmars.com">Home</a>
| <a href="../advancedsearch.html" title="Search Digital Mars web site">Search</a>
| <a href="ctg.html" title="Compiler & Tools Guide">CTG</a>
| <a href="../rtl/rtl.html" title="Runtime Library Reference">RTL</a>
| <a href="../ugr/ugr.html" title="IDDE Reference">IDDE</a>
| <a href="../stl/index.html" title="Standard Template Library">STL</a>

	<div id="lastupdate">Last update Fri Apr 28 16:25:46 2006
</div>
</div>

<!-- Generated by Ddoc from lib.d -->


<table border=1 cellpadding=8 cellspacing=0 frame="void" summary="this table is for layout only">
<tr>
<td valign="top" class="toc" nowrap>
<small>
<center>
<form method="get" action="http://www.google.com/search">
<input id="q" name="q" size="10" value="Search" onFocus='if(this.value == "Search"){this.value="";}'>
<input type="hidden" id="domains" name="domains" value="www.digitalmars.com">
<input type="hidden" id="sitesearch" name="sitesearch" value="www.digitalmars.com/ctg">
<input type="hidden" id="sourceid" name="sourceid" value="google-search">
<input type="submit" id="submit" name="submit" value="Go">
</form>
</center>

    <a href="ctg.html"><b>Compiler & Tools Guide</b></a><br>

<hr><b>Compiling</b><br>

    &#149; <a href="ctgCompilingCode.html">Compiling Code</a><br>
    &#149; <a href="C-Language-Implementation.html">C Implementation</a><br>
    &#149; <a href="CPP-Language-Implementation.html">C++ Implementation</a><br>
    &#149; <a href="ctgLanguageImplementation.html">Language Extensions</a><br>
    &#149; <a href="ctgMixingLanguages.html">Mixing Languages</a><br>
    &#149; <a href="ctgAsm.html">Assembly Language</a><br>
    &#149; <a href="ctgInlineAsm.html">Inline Assembler</a><br>
    &#149; <a href="ctgOptimizer.html">Optimizing Code</a><br>
    &#149; <a href="ctgNumerics.html">Numerics Programming</a><br>
    &#149; <a href="regular.html">Regular Expressions</a><br>
    &#149; <a href="acrtused.html">Acrtused</a><br>
    &#149; <a href="pragmas.html">Pragmas</a><br>
    &#149; <a href="precompiled.html">Precompiled Headers</a><br>
    &#149; <a href="predefined.html">Predefined Macros</a><br>
    &#149; <a href="warnings.html">Warning Messages</a><br>
    &#149; <a href="ctgCompilerErrors.html">Error Messages</a><br>
    &#149; <a href="warnings.html#runtime">Runtime Messages</a><br>
    <br>

<hr><b>Linking</b><br>

    &#149; <a href="optlink.html">Optlink</a><br>
    &#149; <a href="ctgLinkSwitches.html">Switches</a><br>
    &#149; <a href="ctgDefFiles.html">Module Definition Files</a><br>
    &#149; <a href="ctgLinkOps.html">Operation and Design</a><br>
    &#149; <a href="OptlinkErrorMessages.html">Error Messages</a><br>
    <br>

<hr><b>Win32 Programming</b><br>

    &#149; <a href="win32programming.html#win32">Win32 Programming</a><br>
    <br>

<hr><b>DOS and Win16<br>Programming</b><br>

    &#149; <a href="ctgMemoryModel.html">Memory Models</a><br>
    &#149; <a href="pointers16.html">16 Bit Pointer Types<br> and Type Modifiers</a><br>
    &#149; <a href="win32programming.html#handle">Handle Pointers</a><br>
    &#149; <a href="win32programming.html#dos">DOS</a><br>
    &#149; <a href="dos32.html">DOS 32 (DOSX)</a><br>
    &#149; <a href="win32programming.html#win16">Win16</a><br>
    &#149; <a href="win32programming.html#win16dll">Win16 DLLs</a><br>
    &#149; <a href="windowspe.html">Win16 Prolog/Epilog</a><br>
    <br>

<hr><b>C/C++ Extensions</b><br>

    &#149; <a href="contract.html">Contract Programming</a><br>
    &#149; <a href="debugstatement.html">__debug statement</a><br>
    &#149; <a href="debugstatement.html#debugdeclaration">__debug declaration</a><br>
    &#149; <a href="trace.html">Dynamic Profiling</a><br>
    &#149; <a href="html.html">Embedding C in HTML</a><br>
    <br>

<hr><b>Tools</b><br>

    &#149; <a href="bcc.html" title="Convert Borland compiler commands">BCC</a><br>
    &#149; <a href="chmod.html" title="Examine and change file attributes">CHMOD</a><br>
    &#149; <a href="cl.html" title="Convert Microsoft compiler commands">CL</a><br>
    &#149; <a href="coff2omf.html" title="Convert COFF .obj and .lib to OMF">COFF2OMF</a><br>
    &#149; <a href="coffimplib.html" title="Convert COFF import library OMF">COFFIMPLIB</a><br>
    &#149; <a href="sc.html" title="Compiler command">DMC</a><br>
    &#149; <a href="diff.html" title="Compare files">DIFF</a><br>
    &#149; <a href="diffdir.html" title="Compare directories">DIFFDIR</a><br>
    &#149; <a href="dump.html" title="Dump files in hex">DUMP</a><br>
    &#149; <a href="dumpobj.html" title="Dump object files in hex">DUMPOBJ</a><br>
    &#149; <a href="dumpexe.html" title="Dump exe files">DUMPEXE</a><br>
    &#149; <a href="exe2bin.html" title="Create .com files">EXE2BIN</a><br>
    &#149; <a href="flpyimg.html" title="Read/Write Floppy Image">FLPYIMG</a><br>
    &#149; <a href="grep.html" title="Search files for string">GREP</a><br>
    &#149; <a href="ctgHelp.html" title="Creating Help Tools">HC</a><br>
    &#149; <a href="implib.html" title="Build import libraries">IMPLIB</a><br>
    &#149; <a href="lib.html" title="Object file librarian">LIB</a><br>
    &#149; <a href="libunres.html" title="Analyze library and object files">LIBUNRES</a><br>
    &#149; <a href="make.html" title="Simple make utility">MAKE</a><br>
    &#149; <a href="makedep.html" title="Update makefile dependencies">MAKEDEP</a><br>
    &#149; <a href="me.html" title="MicroEmacs Text Editor">ME</a><br>
    &#149; <a href="obj2asm.html" title="Object file disassembler">OBJ2ASM</a><br>
    &#149; <a href="patchobj.html" title="Patch object files">PATCHOBJ</a><br>
    &#149; <a href="ctgRC.html" title="Microsoft Resource compiler">RC</a><br>
    &#149; <a href="rcc.html" title="Digital Mars Resource compiler">RCC</a><br>
    &#149; <a href="sc.html" title="Compiler command">SC</a><br>
    &#149; <a href="shell.html" title="Shell scripts">SHELL</a><br>
    &#149; <a href="smake.html" title="Manage complex projects">SMAKE</a><br>
    &#149; <a href="touch.html" title="Set file timestamps">TOUCH</a><br>
    &#149; <a href="unmangle.html" title="Format C++ mangled names">UNMANGLE</a><br>
    &#149; <a href="whereis.html" title="Search for files">WHEREIS</a><br>
    <br>

<hr><b>Porting to DMC++</b><br>

    &#149; <a href="switchtodigitalmars.html">Switching to DMC++</a><br>
    &#149; <a href="switchtodigitalmars.html#microsoft">from Microsoft</a><br>
    &#149; <a href="switchtodigitalmars.html#borland">from Borland</a><br>
    &#149; <a href="ctgPorting.html">Porting Guide</a><br>
    <br>

</small>

<hr>

</td>
<td valign="top">

<h1>LIB: Object File Librarian</h1>

A library manager is a utility that maintains object library files. Object 
libraries are collections of related object (<tt>.obj</tt>) files,
such as a set of 
graphics functions, or the run-time libraries supplied with this 
compiler. Object libraries are useful for linking them as a 
single, convenient file, rather than as many separate files. Creating 
an object library does not change the contents of the object files or 
how they work. A library just gathers object files in one place. 
<p>

Use LIB to create, maintain, and customize object library files. LIB 
enables putting objects into libraries, replacing objects with newer 
versions, deleting objects from libraries, and extracting
objects from libraries.
LIB can generate a text listing of the contents of a library. 
<p>

LIB handles both 16-and 32-bit object files in Intel OMF format.


<hr>
<h2>LIB command syntax</h2>

<pre>
	<b>lib</b> <i>switches</i>... <i>libfile</i> <i>objfiles</i>...
</pre>

<dl>
    <dt> <i>switches</i>...
    <dd> Zero or more of the following.
    If none of -c, -d or -x is specified, the default action is to
    add the <i>objfiles</i> to the library.
    <dl>
	<dt><b>-c</b>
	<dd>Create new library and insert <i>objfiles</i> into it.

	<dt><b>-d</b>
	<dd>Delete <i>objfiles</i> from library.

	<dt><b>-h</b>
	<dd>Print brief help.

	<dt><b>-i</b>
	<dd>Ignore case of public symbols. The default is to be
	case sensitive.

	<dt><b>-n</b>
	<dd>Do not make a backup file of the original library.

	<dt><b>-l</b>
	<dd>Create text listing file of the symbols in the library.
	The listing file will be the name of the library with the <b>.lst</b>
	extension.

	<dt><b>-p</b><i>nnn</i>
	<dd>Set page size to <i>nnn</i> (a power of 2).

 	<dt><b>-x</b>
	<dd>Extract <i>objfiles</i> from library.
    </dl>

    <dt> <i>libfile</i>
    <dd> The name of the library file. The default extension is <b>.lib</b>.

    <dt> <i>objfiles</i>...
    <dd> List of object files to be added, deleted, or extracted.
    The default extension is <b>.obj</b>.
    Library files can also be specified here, in order to insert
    whole libraries.
</dl>

<h3>Backup Libraries</h3>

	If a library file is modified or rewritten, an existing library
	file of the same name is renamed to a file with a <b>.bak</b>
	extension. (This action is disabled with the <b>-n</b> switch.)
	Any previous file of the same name with the <b>.bak</b> extension
	is deleted.

<h3>Examples</h3>

<pre>
	lib -h
</pre>

	Print help message.

<pre>
	lib foo a b c.obj
</pre>

	Create a library <tt>foo.lib</tt> and insert the object files
	<tt>a.obj</tt> <tt>b.obj</tt> and <tt>c.obj</tt>.

<pre>
	lib -l foo
</pre>

	Create listing file <tt>foo.lst</tt> of contents of <tt>foo.lib</tt>.

<pre>
	lib -d foo.lib a
</pre>

	Delete the object <tt>a.obj</tt> from <tt>foo.lib</tt>.

<pre>
	lib -x foo.lib b
</pre>

	Extract the object <tt>b.obj</tt> from <tt>foo.lib</tt> and
	write it to file <tt>b.obj</tt>.

<pre>
	lib foo.lib bar.lib a.obj
</pre>

	Add the contents of <tt>bar.lib</tt> and
	<tt>a.obj</tt> to <tt>foo.lib</tt>.


<h3>Using LIB with SMAKE</h3>

	The usual technique is:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		lib -c foo.lib 
</pre>

	If the list of OBJS gets too long for the command line, SMAKE can
	automatically create a response file. Use an SMAKE command like:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		lib -c foo.lib \
			@&lt;&lt;
			
	&lt;&lt;
</pre>

<h3>Using LIB with MAKE</h3>

	The usual technique is:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		lib -c foo.lib 
</pre>

	If the list of OBJS gets too long for the command line,
	MAKE will automatically create a response file that LIB will
	use.

<hr>
<h2>Obsolete LIB command syntax</h2>

For compatibility with older makefiles and batch files, LIB supports
an older command line syntax. Such makefiles should be upgraded to the
new command syntax.
<p>

Arguments are passed to LIB via:
<ol>
	<li> the command line
	<li> a response file (similar to the linker response file)
	<li> interactively from the command prompt
</ol>

LIB commands have the following format: 
<pre>
	<b>lib</b> <i>lib-file</i> [<i>switches</i>][<i>action-files</i>]<b>,</b>[<i>list-file</i>][<b>;</b>] 
</pre>
<i>lib-file</i> is the name of the library file to create or change.
Its default file extension is <b>.lib</b>.
<p>
The <i>switches</i> are:
<dl><dl>
	<dt> <b>/?</b>, <b>/H</b> <dd>Print help information. 
	<dt> <b>/B</b> <dd>Run LIB in batch mode. 
	<dt> <b>/C</b> <dd>Create a new library <i>lib-file</i> if one
	does not exist. Use to create a new library without 
	being prompted to do so. 
	<dt> <b>/I</b> <dd>Ignore case in public symbols (default). 
	<dt> <b>/N</b> <dd>Do not back up the original library.
	The default behavior is to save a backup of the original library file 
	with the extension <b>.bak</b>. 
	<dt> <b>/NOE</b> <dd>LIB ignores this switch. 
	<dt> <b>/NOI</b> <dd>Treat uppercase and lowercase letters as distinct, and 
	mark the library as case-sensitive. This applies only to 
	public symbols. The default is <b>/I</b>. 
	<dt> <b>/NOL</b> <dd>Do not display copyright message. 
	<dt> <b>/P:</b><i>num</i> <dd>Set page size to <i>num</i> (a power of 2). 
</dl></dl>

The <i>action-files</i> specify the objects on which to act and 
what to do with them. The <i>action-files</i> must be one or 
more object files in the current directory. The default extension
for object files is <b>.obj</b>. When LIB puts an 
object file into a library, it gives the object's module the name of the 
object file in uppercase and without an extension. 
<p>
To specify what to do with each object file, put one of 
the following switches before the name(s) of the <i>action-files</i>: 

<dl><dl>
	<dt> <b>-</b> <dd>Removes the object from the library.
	<dt> <b>+</b> <dd>Adds the object to the library.
	If the library already contains an object of the same name, 
	LIB prints an error message and doesn't add the object. 
	<dt> <b>*</b> <dd>Copies the object into a separate object file,
	leaving the object in the library.
	<dt> <b>+-</b>, <b>-+</b> <dd>Replaces an existing object in the library
	with a new version.
	<dt> <b>*-</b>, <b>-*</b> <dd>Extracts the object module into an object
	file and deletes it from the library.
</dl></dl>

The <i>list-file</i> produces a file listing the contents of the library.
The file 
first lists all the public symbols in alphabetical order with the name 
of the modules to which they belong. Next, it lists the modules 
alphabetically with the public symbols in them.
The default <i>list-file</i> extension is <b>.lst</b>.
If there is a <i>list-file</i> 
but no <i>action-files</i>, LIB produces a list file without modifying the 
library. 


<h3>Concatenating libraries</h3>

To concatenate two libraries, specify one as the <i>lib-file</i> and the other 
as an <i>action-file</i>. LIB adds the modules from the <i>action-file</i>
library to the other library without changing the names of the modules. 
<p>

<b>Note:</b>
	LIB doesn't allow two modules to contain the same 
	public symbol. 


<h3>Using LIB interactively</h3>

If LIB is run with no arguments, it prompts for the required 
arguments. Use the ampersand (<b>&amp;</b>) character to continue input on a 
new line. 


<h3>Response files</h3>

You can use LIB with a response file, which contains the responses 
that the compiler would ask for if used interactively. For 
example, the response file below adds several objects to the library 
<tt>mywindow.lib</tt> and produces a listing file: 

<pre>
	\dm\lib\mywindow.lib /c
	+winopen+winblank+winmove+winhide&amp; 
	+winshow+winputs+wingets+winprint
	\dm\mywin.lst; 
</pre>

If the response file is <tt>makewin.rsp</tt>, use LIB like this: 
<pre>
	lib @makewin.rsp 
</pre>
Don't use filenames beginning with <b>@</b> because LIB mistakes
it for a response file. 

<h3>Using LIB with SMAKE</h3>

	The usual technique is:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		-del foo.lib
		lib foo.lib/C/NOI +a+b+c;
</pre>

	If the list of OBJS gets too long for the command line, SMAKE can
	automatically create a response file. Use an SMAKE command like:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		-del foo.lib
		lib foo.lib/C/NOI \
			@&lt;&lt;
			+a&amp;
			+b&amp;
			+c;
	&lt;&lt;
</pre>



<h3>Using LIB with MAKE</h3>

	The usual technique is:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		-del foo.lib
		lib foo.lib/C/NOI +a+b+c;
</pre>

	If the list of OBJS gets too long for the command line,
	use multiple LIB commands:

<pre>
	OBJS=a.obj b.obj c.obj

	foo.lib : 
		-del foo.lib
		lib foo.lib/C/NOI +a+b;
		lib foo.lib/NOI +c;
</pre>


<hr>
<h3>Bugs</h3>

<ul>
	<li> LIB doesn't work with COFF files. To work around, use
	<a href="coff2omf.html">COFF2OMF</a>
	to convert them to Intel OMF format.

	<li>Due to the Microsoft OMF lib file format, there is a
	hard limit on the length of an identifier of slightly less
	than 512 characters. The only way around this is to use
	a shorter name, or to link in those modules separately that
	use longer names.
</ul>


<br><br><br><br>

</td></table>





<div id="copyright">
Copyright &copy; 1999-2006 by Digital Mars, All Rights Reserved |
Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>.
</div>

</body>
</html>

