
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>

<!--
	Copyright (c) 1999-2006 by Digital Mars
	All Rights Reserved
	Written by Walter Bright
	www.digitalmars.com
  -->

<head>
<META http-equiv="content-type" content="text/html; charset=utf-8">
<title>Digital Mars - Runtime Library - page.h
</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
<div id="heading">
<a href="http://www.digitalmars.com/" target="_top"><IMG SRC="dmlogo.gif" BORDER=0 WIDTH=270 HEIGHT=53 ALT="www.digitalmars.com"></a>

<a href="http://www.digitalmars.com/" title="www.digitalmars.com">Home</a>
| <a href="../advancedsearch.html" title="Search Digital Mars web site">Search</a>
| <a href="../ctg/ctg.html" title="Compiler & Tools Guide">CTG</a>
| <a href="../rtl/rtl.html" title="Runtime Library Reference">RTL</a>
| <a href="../ugr/ugr.html" title="IDDE Reference">IDDE</a>
| <a href="../stl/index.html" title="Standard Template Library">STL</a>
| <a href="http://www.digitalmars.com/download/freecompiler.html" title="download C & C++ compiler">C/C++ Compiler</a>
| <a href="http://www.digitalmars.com/d/" title="D Programming Language">D</a>

	<div id="lastupdate">Last update Fri Apr 28 16:28:15 2006
</div>
</div>

<!-- Generated by Ddoc from page.d -->




<table border=1 cellpadding=8 cellspacing=0 frame="void" summary="this table is for layout only">
<tr>
<td valign="top" class="toc" nowrap>
<small>
<center>
<form method="get" action="http://www.google.com/search">
<input id="q" name="q" size="10" value="RTL Search" onFocus='if(this.value == "RTL Search"){this.value="";}'>
<input type="hidden" id="domains" name="domains" value="www.digitalmars.com">
<input type="hidden" id="sitesearch" name="sitesearch" value="www.digitalmars.com/rtl">
<input type="hidden" id="sourceid" name="sourceid" value="google-search">
<input type="submit" id="submit" name="submit" value="Go">
</form>

    <a href="rtl.html"><b>Runtime Library<br>Reference</b></a><br><br>
</center>

    &#183; <a href="constants.html">Constants</a><br>
    &#183; <a href="datatypes.html">Data types</a><br>

<hr><b>Standard C</b><br>

    &#183; <a href="assert.html">assert.h</a><br>
    &#183; <a href="complex.html">complex.h</a><br>
    &#183; <a href="ctype.html" title="character classification">ctype.h</a><br>
    &#183; <a href="fenv.html">fenv.h</a><br>
    &#183; <a href="float.html">float.h</a><br>
    &#183; <a href="locale.html">locale.h</a><br>
    &#183; <a href="math.html" title="math and trig">math.h</a><br>
    &#183; <a href="setjmp.html">setjmp.h</a><br>
    &#183; <a href="signal.html">signal.h</a><br>
    &#183; <a href="stdarg.html">stdarg.h</a><br>
    &#183; <a href="stddef.html">stddef.h</a><br>
    &#183; <a href="stdio.html">stdio.h</a><br>
    &#183; <a href="stdlib.html">stdlib.h</a><br>
    &#183; <a href="string.html">string.h</a><br>
    &#183; <a href="time.html">time.h</a><br>
    <br>

<hr><b>Standard C++</b><br>
    &#183; <a href="iostream.html">IOstream</a><br>
    &#183; <a href="new.html">new</a><br>
    <br>

<hr><b>Win32</b><br>
    &#183; <a href="gc.html" title="Hans Boehm garbage collector">gc.h</a><br>
    <br>

<hr><b>DOS, DOS32, Win16</b><br>
    &#183; <a href="bios.html" title="interface to BIOS API">bios.h</a><br>
    &#183; <a href="cerror.html" title="critical errors">cerror.h</a><br>
    &#183; <a href="disp.html" title="direct access to video display">disp.h</a><br>
    &#183; <a href="dos.html" title="interface to DOS API">dos.h</a><br>
    &#183; <a href="dos2.html">dos.h part 2</a><br>
    &#183; <a href="emm.html" title="expanded memory">emm.h</a><br>
    &#183; <a href="handle.html" title="handle pointers">handle.h</a><br>
    &#183; <a href="int.html" title="interrupt functions">int.h</a><br>
    &#183; <a href="msmouse.html" title="DOS mouse functions">msmouse.h</a><br>
    &#183; <a href="sound.html" title="interface to PC speaker">sound.h</a><br>
    &#183; <a href="swap.html">swap.h</a><br>
    &#183; <a href="tsr.html" title="Terminate Stay Resident functions">tsr.h</a><br>
    &#183; <a href="winio.html" title="Andrew Schulman's winio library">winio.h</a><br>
    <br>

<hr><b>Other C</b><br>
    &#183; <a href="bitops.html" title="access to CPU bit instructions">bitops.h</a><br>
    &#183; <a href="conio.html" title="console I/O">conio.h</a><br>
    &#183; <a href="controlc.html" title="control C">controlc.h</a><br>
    &#183; <a href="direct.html" title="directories">direct.h</a><br>
    &#183; <a href="fltpnt.html">fltpnt.h</a><br>
    &#183; <a href="io.html" title="low level file I/O">io.h</a><br>
    &#183; <a href="page.html" title="suballocate blocks of memory">page.h</a><br>
    &#183; <a href="process.html">process.h</a><br>
    &#183; <a href="search.html">search.h</a><br>
    &#183; <a href="sys-stat.html">sys\stat.h</a><br>
    &#183; <a href="tabsize.html">tabsize.h</a><br>
    &#183; <a href="../ctg/trace.html" title="Trace Dynamic Profiling">trace.h</a><br>
    &#183; <a href="time.html">utime.h</a><br>
    &#183; <a href="unmangle.html">unmangle.h</a><br>
    &#183; <a href="util.html">util.h</a><br>
    <br>

<hr><b>Other C++</b><br>
    &#183; <a href="regexp.html" title="regular expressions">regexp.h</a><br>
    &#183; <a href="oldcomplex.html">class complex</a><br>
    <br>

</small>

<hr>

</td>
<td valign="top">


<h1>page.h</h1>

<ul>
	<li><a href="#page_calloc"><b>page_calloc</b></a>
	<li><a href="#page_free"><b>page_free</b></a>
	<li><a href="#page_initialize"><b>page_initialize</b></a>
	<li><a href="#page_malloc"><b>page_malloc</b></a>
	<li><a href="#page_maxfree"><b>page_maxfree</b></a>
	<li><a href="#page_realloc"><b>page_realloc</b></a>
	<li><a href="#page_size"><b>page_size</b></a>
	<li><a href="#page_toptr"><b>page_toptr</b></a>
</ul>

<hr><!-- =========================================== -->

<a name="page_calloc"><h2>page_calloc</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
unsigned page_calloc(void __BF *baseptr, unsigned size);  
<br><br>

<b>
Description
</b><br><br>
The page_calloc function allocates and clears a block of data 
from a page heap that was initialized by page_initialize. 
baseptr points to a page heap initialized by page_initialize. 
size is the number of bytes to allocate. __BF is defined to be __far 
for the 16-bit memory models, and __near for the 32-bit memory 
models. 
<br><br>

<b>
Return Value
</b><br><br>
The offset of the allocated data within baseptr. If the allocation 
fails, 0 is returned. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_malloc">page_malloc</a><br>
<a href="#page_free">page_free</a><br>
<a href="#page_initialize">page_initialize</a><br>
<a href="#page_realloc">page_realloc</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize 
</pre><br>

<hr><!-- =========================================== -->

<a name="page_free"><h2>page_free</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
int page_free(void __BF *baseptr, unsigned p); 
<br><br>

<b>
Description
</b><br><br>
The page_free function frees the memory at offset p in the page 
heap pointed to by baseptr, which was allocated by 
page_malloc or page_calloc. __BF is defined to be __far for 
the 16-bit memory models, and __near for the 32-bit memory 
models. 
<br><br>

<b>
Return Value
</b><br><br>
Returns 0 on success or -1 if an error occurred (for example, if 
baseptr is bad, or memory is corrupted). 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_calloc">page_calloc</a><br>
<a href="#page_malloc">page_malloc</a><br>
<a href="#page_initialize">page_initialize</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize 
</pre><br>


<hr><!-- =========================================== -->

<a name="page_initialize"><h2>page_initialize</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
unsigned page_initialize(void __BF *baseptr, unsigned pagesize); 
<br><br>

<b>
Description
</b><br><br>
The page_initialize function creates a page heap for the block 
of memory pointed to by baseptr which has a size of pagesize. 
The page_initialize function converts the buffer at baseptr 
to a page heap. __BF is defined to be __far for the 16-bit memory 
models, and __near for the 32-bit memory models. <br><br>

If you use page_initialize to create a page heap, you must use 
page_functions to manage this heap. 
<br><br>

<b>
Return Value
</b><br><br>
The size of the largest allocatable block in baseptr. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_calloc">page_calloc</a><br>
<a href="#page_malloc">page_malloc</a><br>
<a href="#page_free">page_free</a>
<br><br>

<b>
Example
</b><br><br><pre>
	/* 	Example for page_initialize */ 

	#include &lt;stdio.h&gt;
	#include &lt;stdlib.h&gt; 
	#include &lt;page.h&gt;
	#include &lt;dos.h&gt;
	#include &lt;io.h&gt; 

	#define HEAPSIZE 0x4000 

	static char buffer[HEAPSIZE]; 

	void main()
	{ 
	   unsigned maxsize, offset;
	   char __far *baseptr; 
	   int __far *fp, i; 

	   baseptr = MK_FP (getDS (), buffer);
	   maxsize = page_initialize (baseptr, HEAPSIZE); 
	   printf (" The maximum allocateable size is
	             %04x bytes\n", maxsize); 

	   if ((offset = page_malloc (baseptr, 0x800)) == 0) 
	   { 
	      printf (" Unable to allocate 0x800 bytes
		        with page_malloc ()\n"); 
	      exit (EXIT_FAILURE);
	   } 

	   printf (" Allocated 0x800 bytes
	             successfully\n"); 

	   fp = page_toptr (baseptr, offset);
	   for (i = 0; i &lt; 255; i++) 
	      fp[i] = i; 

	   printf (" fp[50] = %d\n", fp[50]); 

	   if ((offset = page_realloc (baseptr, offset,
	         0x1000)) == 0) 
	   {

	      printf (" Unable to reallocate 0x1000 
		        bytes\n"); exit (EXIT_FAILURE); 
	   } 

	   printf (" Reallocated to 0x1000 bytes\n"); 

	   fp = page_toptr (baseptr, offset);
	   printf (" fp[50] = %d\n", fp[50]); 
	   maxsize = page_maxfree(baseptr);
	   printf (" Maximum free block remaining is %04x 
                     bytes \n", maxsize); 

	   if (page_free (baseptr, offset) == -1)
	   { 
	      printf (" Unable to free allocated 
	                block\n"); 
	      exit (EXIT_FAILURE);
	   } 

	   printf (" Page freed successfully\n"); 
	} 
</pre><br>

<b>
Output
</b><br><br>
The maximum allocateable size is 3ff4 bytes<br>
Allocated 0x800 bytes successfully<br>
fp[50] = 50<br>
Reallocated to 0x1000 bytes<br>
fp[50] = 50<br>
Maximum free block remaining is 27f0 bytes<br>
Page freed successfully 




<hr><!-- =========================================== -->

<a name="page_malloc"><h2>page_malloc</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
unsigned page_malloc(void __BF *baseptr, unsigned size); 
<br><br>

<b>
Description
</b><br><br>
The page_malloc function allocates a block of data from a page 
heap. baseptr points to a page heap that was initialized by 
page_initialize; size indicates the number of bytes to 
allocate. __BF is defined to be __far for the 16-bit memory models, 
and __near for the 32-bit memory models. 
<br><br>

<b>
Return Value
</b><br><br>
The offset of the allocated data within baseptr. If the allocation 
fails, 0 is returned. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_calloc">page_calloc</a><br>
<a href="#page_initialize">page_initialize</a><br>
<a href="#page_free">page_free</a><br>
<a href="#page_realloc">page_realloc</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize 
</pre><br>

<hr><!-- =========================================== -->

<a name="page_maxfree"><h2>page_maxfree</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
unsigned page_maxfree(void __BF *baseptr); 
<br><br>

<b>
Description
</b><br><br>
The page_maxfree function determines size of largest free block 
in the page heap pointed to by baseptr. This heap must have 
been initialized with page_initialize. __BF is defined to be 
__far for the 16-bit memory models, and __near for the 32-bit 
memory models. 
<br><br>

<b>
Return Value
</b><br><br>
The size of the largest free block. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_initialize">page_initialize</a><br>
<a href="#page_free">page_free</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize
</pre><br>


<hr><!-- =========================================== -->

<a name="page_realloc"><h2>page_realloc</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
unsigned page_realloc(void __BF *baseptr, unsigned p, unsigned nbytes); 
<br><br>

<b>
Description
</b><br><br>
The page_realloc function reallocates (changes the size of) a 
block of memory that was allocated by page_malloc or 
page_calloc. __BF is defined to be __far for the 16-bit memory 
models, and __near for the 32-bit memory models. 
<br><br>

<b>
Return Value
</b><br><br>
The offset of the reallocated data block from baseptr. If the 
reallocation fails, 0 is returned. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_calloc">page_calloc</a><br>
<a href="#page_malloc">page_malloc</a><br>
<a href="#page_initialize">page_initialize</a><br>
<a href="#page_free">page_free</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize 
</pre><br>

<hr><!-- =========================================== -->

<a name="page_size"><h2>page_size</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
unsigned page_size(void __far *baseptr, unsigned p);  
<br><br>

<b>
Description
</b><br><br>
The page_size function returns the number of bytes allocated for 
the block of memory at offset p that was allocated by 
page_malloc, page_calloc, or page_realloc. 
<br><br>

<b>
Return Value
</b><br><br>
The number of bytes in the block. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_calloc">page_calloc</a><br>
<a href="#page_malloc">page_malloc</a><br>
<a href="#page_initialize">page_initialize</a><br>
<a href="#page_free">page_free</a><br>
<a href="#page_realloc">page_realloc</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize 
</pre><br>

<hr><!-- =========================================== -->

<a name="page_toptr"><h2>page_toptr</h2></a>

<font size=3><b>
Header
</b><br><br>
page.h
<br><br>

<b>
Prototype
</b><br><br>
void __BF * __near page_toptr(void __BF *baseptr, unsigned p); 
<br><br>

<b>
Description
</b><br><br>
The page_toptr function converts a pointer to a page heap, and 
an offset into it of p, into a void *pointer. baseptr is a pointer to 
a heap that was initialized with page_initialize; p is an offset into the 
heap. __BF is defined to be __far for the 16-bit memory models, and 
__near for the 32-bit memory models. 
<br><br>

<b>
Return Value
</b><br><br>
A far pointer to the position in the page corresponding to offset p. 
<br><br>

<b>
Compatibility
</b><br><br>
DOS Windows 3.x Phar Lap DOSX Win32 
<br><br>

<b>
See Also
</b><br><br>
<a href="#page_initialize">page_initialize</a>
<br><br>

<b>
Example
</b><br><br><pre>
See page_initialize
</pre>


<br><br><br><br>

</td></table>





<div id="copyright">
Copyright &copy; 1997-2006 by Digital Mars, All Rights Reserved |
Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>.
</div>

</body>
</html>

